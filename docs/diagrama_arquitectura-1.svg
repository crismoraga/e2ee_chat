<svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="-8 -8 2767.87109375 1088" style="max-width: 2767.87px; background-color: white;" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-1763498049380"><style>#mermaid-1763498049380{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1763498049380 .error-icon{fill:#552222;}#mermaid-1763498049380 .error-text{fill:#552222;stroke:#552222;}#mermaid-1763498049380 .edge-thickness-normal{stroke-width:2px;}#mermaid-1763498049380 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1763498049380 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1763498049380 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1763498049380 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1763498049380 .marker{fill:#333333;stroke:#333333;}#mermaid-1763498049380 .marker.cross{stroke:#333333;}#mermaid-1763498049380 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1763498049380 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-1763498049380 .cluster-label text{fill:#333;}#mermaid-1763498049380 .cluster-label span{color:#333;}#mermaid-1763498049380 .label text,#mermaid-1763498049380 span{fill:#333;color:#333;}#mermaid-1763498049380 .node rect,#mermaid-1763498049380 .node circle,#mermaid-1763498049380 .node ellipse,#mermaid-1763498049380 .node polygon,#mermaid-1763498049380 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1763498049380 .node .label{text-align:center;}#mermaid-1763498049380 .node.clickable{cursor:pointer;}#mermaid-1763498049380 .arrowheadPath{fill:#333333;}#mermaid-1763498049380 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1763498049380 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1763498049380 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1763498049380 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1763498049380 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1763498049380 .cluster text{fill:#333;}#mermaid-1763498049380 .cluster span{color:#333;}#mermaid-1763498049380 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1763498049380 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-1763498049380 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="10" viewBox="0 0 12 20" class="marker flowchart" id="flowchart-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"/></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="0" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"/></marker><g class="root"><g class="clusters"><g id="subGraph6" class="cluster default"><rect height="435" width="500.125" y="0" x="0" ry="0" rx="0" style=""/><g transform="translate(168.8671875, 0)" class="cluster-label"><foreignObject height="19" width="162.390625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Base de Datos (SQLite)</span></div></foreignObject></g></g><g id="subGraph5" class="cluster default"><rect height="906" width="673.21484375" y="166" x="520.125" ry="0" rx="0" style=""/><g transform="translate(787.654296875, 166)" class="cluster-label"><foreignObject height="19" width="138.15625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Servidor (Flask API)</span></div></foreignObject></g></g><g id="subGraph3" class="cluster default"><rect height="153" width="245.3125" y="657" x="1213.33984375" ry="0" rx="0" style=""/><g transform="translate(1246.23828125, 657)" class="cluster-label"><foreignObject height="19" width="179.515625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Canal Inseguro (Internet)</span></div></foreignObject></g></g><g id="subGraph2" class="cluster default"><rect height="516" width="1273.21875" y="294" x="1478.65234375" ry="0" rx="0" style=""/><g transform="translate(2025.93359375, 294)" class="cluster-label"><foreignObject height="19" width="178.65625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Cliente (Navegador Web)</span></div></foreignObject></g></g><g id="subGraph4" class="cluster default"><rect height="103" width="633.21484375" y="944" x="540.125" ry="0" rx="0" style=""/><g transform="translate(770.841796875, 944)" class="cluster-label"><foreignObject height="19" width="171.78125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Criptografía de Servidor</span></div></foreignObject></g></g><g id="subGraph0" class="cluster default"><rect height="103" width="671.109375" y="682" x="1925.58984375" ry="0" rx="0" style=""/><g transform="translate(2189.37109375, 682)" class="cluster-label"><foreignObject height="19" width="143.546875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Memoria Volátil (JS)</span></div></foreignObject></g></g><g id="subGraph1" class="cluster default"><rect height="103" width="757.18359375" y="485" x="1826.08984375" ry="0" rx="0" style=""/><g transform="translate(2131.767578125, 485)" class="cluster-label"><foreignObject height="19" width="145.828125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Operaciones Locales</span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-UI LE-GenKey" id="L-UI-GenKey-0" d="M1991.5809507978724,391L2001.3656360815603,398.3333333333333C2011.1503213652484,405.6666666666667,2030.719691932624,420.3333333333333,2040.504377216312,431.8333333333333C2050.2890625,443.3333333333333,2050.2890625,451.6666666666667,2050.2890625,460C2050.2890625,468.3333333333333,2050.2890625,476.6666666666667,2050.2890625,485C2050.2890625,493.3333333333333,2050.2890625,501.6666666666667,2050.2890625,505.8333333333333L2050.2890625,510"/><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-GenKey LE-PrivKey" id="L-GenKey-PrivKey-0" d="M2134.2890625,560.3167702531238L2150.5618489583335,564.9306418776031C2166.8346354166665,569.5445135020825,2199.3802083333335,578.7722567510413,2215.6529947916665,589.1361283755206C2231.92578125,599.5,2231.92578125,611,2231.92578125,622.5C2231.92578125,634,2231.92578125,645.5,2231.92578125,655.4166666666666C2231.92578125,665.3333333333334,2231.92578125,673.6666666666666,2231.92578125,682C2231.92578125,690.3333333333334,2231.92578125,698.6666666666666,2231.92578125,702.8333333333334L2231.92578125,707"/><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-GenKey LE-HTTP" id="L-GenKey-HTTP-0" d="M1975.8321829490292,563L1964.1251264158575,567.1666666666666C1952.418069882686,571.3333333333334,1929.003956816343,579.6666666666666,1917.2969002831715,589.5833333333334C1905.58984375,599.5,1905.58984375,611,1905.58984375,622.5C1905.58984375,634,1905.58984375,645.5,1905.58984375,655.4166666666666C1905.58984375,665.3333333333334,1905.58984375,673.6666666666666,1825.2669270833333,685.095755381211C1744.9440104166667,696.5248440957554,1584.2981770833333,711.0496881915109,1503.9752604166667,718.3121102393884L1423.65234375,725.5745322872662"/><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-UI LE-HTTP" id="L-UI-HTTP-0" d="M1880.19921875,387.1908612820004L1853.5026041666667,395.15905106833367C1826.8059895833333,403.127240854667,1773.4127604166667,419.0636204273335,1746.7161458333333,431.1984768803334C1720.01953125,443.3333333333333,1720.01953125,451.6666666666667,1720.01953125,460C1720.01953125,468.3333333333333,1720.01953125,476.6666666666667,1720.01953125,489.4166666666667C1720.01953125,502.1666666666667,1720.01953125,519.3333333333334,1720.01953125,536.5C1720.01953125,553.6666666666666,1720.01953125,570.8333333333334,1720.01953125,585.1666666666666C1720.01953125,599.5,1720.01953125,611,1720.01953125,622.5C1720.01953125,634,1720.01953125,645.5,1720.01953125,655.4166666666666C1720.01953125,665.3333333333334,1720.01953125,673.6666666666666,1670.625,684.4574560065099C1621.23046875,695.2482453463534,1522.44140625,708.4964906927067,1473.046875,715.1206133658834L1423.65234375,721.7447360390602"/><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-HTTP LE-AuthLayer" id="L-HTTP-AuthLayer-0" d="M1335.99609375,750.5L1335.99609375,756.25C1335.99609375,762,1335.99609375,773.5,1335.99609375,783.4166666666666C1335.99609375,793.3333333333334,1335.99609375,801.6666666666666,1267.1041666666667,810C1198.2122395833333,818.3333333333334,1060.4283854166667,826.6666666666666,991.5364583333334,835C922.64453125,843.3333333333334,922.64453125,851.6666666666666,922.64453125,855.8333333333334L922.64453125,860"/><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-AuthLayer LE-PW_Check" id="L-AuthLayer-PW_Check-0" d="M852.981212797619,894L835.9068700396825,898.1666666666666C818.832527281746,902.3333333333334,784.6838417658731,910.6666666666666,767.6094990079365,919C750.53515625,927.3333333333334,750.53515625,935.6666666666666,743.1989279935275,944C735.8626997370551,952.3333333333334,721.1902432241101,960.6666666666666,713.8540149676375,964.8333333333334L706.5177867111651,969"/><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-AuthLayer LE-TOTP_Check" id="L-AuthLayer-TOTP_Check-0" d="M922.64453125,894L922.64453125,898.1666666666666C922.64453125,902.3333333333334,922.64453125,910.6666666666666,922.64453125,919C922.64453125,927.3333333333334,922.64453125,935.6666666666666,917.6741757686085,944C912.7038202872168,952.3333333333334,902.7631093244336,960.6666666666666,897.7927538430421,964.8333333333334L892.8223983616505,969"/><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-AuthLayer LE-Token_Sign" id="L-AuthLayer-Token_Sign-0" d="M1000.0394345238095,894L1019.008773561508,898.1666666666666C1037.9781125992065,902.3333333333334,1075.9167906746031,910.6666666666666,1094.8861297123015,919C1113.85546875,927.3333333333334,1113.85546875,935.6666666666666,1110.660940028317,944C1107.4664113066344,952.3333333333334,1101.0773538632686,960.6666666666666,1097.8828251415857,964.8333333333334L1094.6882964199028,969"/><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-Token_Sign LE-UI" id="L-Token_Sign-UI-0" d="M1059.5211240898059,969L1057.1862231998382,964.8333333333334C1054.8513223098705,960.6666666666666,1050.1815205299354,952.3333333333334,1047.8466196399677,944C1045.51171875,935.6666666666666,1045.51171875,927.3333333333334,1045.51171875,916.1666666666666C1045.51171875,905,1045.51171875,891,1045.51171875,877C1045.51171875,863,1045.51171875,849,1323.1197916666667,837.8333333333334C1600.7278645833333,826.6666666666666,2155.9440104166665,818.3333333333334,2433.5520833333335,810C2711.16015625,801.6666666666666,2711.16015625,793.3333333333334,2711.16015625,780.5833333333334C2711.16015625,767.8333333333334,2711.16015625,750.6666666666666,2711.16015625,733.5C2711.16015625,716.3333333333334,2711.16015625,699.1666666666666,2711.16015625,686.4166666666666C2711.16015625,673.6666666666666,2711.16015625,665.3333333333334,2711.16015625,655.4166666666666C2711.16015625,645.5,2711.16015625,634,2711.16015625,622.5C2711.16015625,611,2711.16015625,599.5,2711.16015625,585.1666666666666C2711.16015625,570.8333333333334,2711.16015625,553.6666666666666,2711.16015625,536.5C2711.16015625,519.3333333333334,2711.16015625,502.1666666666667,2711.16015625,489.4166666666667C2711.16015625,476.6666666666667,2711.16015625,468.3333333333333,2711.16015625,460C2711.16015625,451.6666666666667,2711.16015625,443.3333333333333,2598.0078125,428.5999108300908C2484.85546875,413.86648832684824,2258.55078125,392.73297665369654,2145.3984375,382.1662208171206L2032.24609375,371.5994649805447"/><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-UI LE-HTTP" id="L-UI-HTTP-1" d="M1880.19921875,377.9017483883571L1826.2161458333333,387.41812365696427C1772.2330729166667,396.9344989255714,1664.2669270833333,415.96724946278573,1610.2838541666667,429.65029139805955C1556.30078125,443.3333333333333,1556.30078125,451.6666666666667,1556.30078125,460C1556.30078125,468.3333333333333,1556.30078125,476.6666666666667,1556.30078125,489.4166666666667C1556.30078125,502.1666666666667,1556.30078125,519.3333333333334,1556.30078125,536.5C1556.30078125,553.6666666666666,1556.30078125,570.8333333333334,1556.30078125,585.1666666666666C1556.30078125,599.5,1556.30078125,611,1556.30078125,622.5C1556.30078125,634,1556.30078125,645.5,1556.30078125,655.4166666666666C1556.30078125,665.3333333333334,1556.30078125,673.6666666666666,1531.703655946602,683.5833333333334C1507.106530643204,693.5,1457.9122800364078,705,1433.3151547330099,710.75L1408.7180294296118,716.5"/><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-HTTP LE-Relay" id="L-HTTP-Relay-0" d="M1248.33984375,723.0035422343324L1191.26953125,716.1696185286104C1134.19921875,709.3356948228883,1020.05859375,695.6678474114442,962.98828125,684.6672570390555C905.91796875,673.6666666666666,905.91796875,665.3333333333334,905.91796875,655.4166666666666C905.91796875,645.5,905.91796875,634,905.91796875,622.5C905.91796875,611,905.91796875,599.5,905.91796875,585.1666666666666C905.91796875,570.8333333333334,905.91796875,553.6666666666666,905.91796875,536.5C905.91796875,519.3333333333334,905.91796875,502.1666666666667,905.91796875,489.4166666666667C905.91796875,476.6666666666667,905.91796875,468.3333333333333,905.91796875,460C905.91796875,451.6666666666667,905.91796875,443.3333333333333,905.91796875,427.4166666666667C905.91796875,411.5,905.91796875,388,905.91796875,364.5C905.91796875,341,905.91796875,317.5,905.91796875,300C905.91796875,282.5,905.91796875,271,904.8014638956311,259.5C903.6849590412621,248,901.4519493325242,236.5,900.3354444781553,230.75L899.2189396237864,225"/><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-Relay LE-Messages" id="L-Relay-Messages-0" d="M869.5540427791262,225L860.6368325242719,230.75C851.7196222694174,236.5,833.8852017597087,248,824.9679915048545,259.5C816.05078125,271,816.05078125,282.5,757.5631510416666,297.4662635875497C699.0755208333334,312.4325271750993,582.1002604166666,330.8650543501986,523.6126302083334,340.0813179377483L465.125,349.2975815252979"/><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-Devices LE-Relay" id="L-Devices-Relay-0" d="M250.0625,97L250.0625,102.75C250.0625,108.5,250.0625,120,250.0625,131.5C250.0625,143,250.0625,154.5,345.5826822916667,166.46168024483032C441.1028645833333,178.42336048966067,632.1432291666666,190.84672097932128,727.6634114583334,197.0584012241516L823.18359375,203.2700814689819"/><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-Relay LE-UI" id="L-Relay-UI-0" d="M918.0241580703884,225L925.5012515169902,230.75C932.9783449635921,236.5,947.9325318567961,248,955.4096253033981,259.5C962.88671875,271,962.88671875,282.5,1115.7721354166667,299.10073183008643C1268.6575520833333,315.70146366017286,1574.4283854166667,337.4029273203457,1727.3138020833333,348.25365915043216L1880.19921875,359.1043909805186"/><path marker-end="url(#flowchart-pointEnd)" style="fill:none;stroke-width:2px;stroke-dasharray:3;" class="edge-thickness-normal edge-pattern-dotted flowchart-link LS-Users LE-PW_Check" id="L-Users-PW_Check-0" d="M99.9996952570922,410L97.38190750591018,414.1666666666667C94.76411975472813,418.3333333333333,89.52854425236406,426.6666666666667,176.19395962618205,435C262.859375,443.3333333333333,441.42578125,451.6666666666667,530.708984375,460C619.9921875,468.3333333333333,619.9921875,476.6666666666667,619.9921875,489.4166666666667C619.9921875,502.1666666666667,619.9921875,519.3333333333334,619.9921875,536.5C619.9921875,553.6666666666666,619.9921875,570.8333333333334,619.9921875,585.1666666666666C619.9921875,599.5,619.9921875,611,619.9921875,622.5C619.9921875,634,619.9921875,645.5,619.9921875,655.4166666666666C619.9921875,665.3333333333334,619.9921875,673.6666666666666,619.9921875,686.4166666666666C619.9921875,699.1666666666666,619.9921875,716.3333333333334,619.9921875,733.5C619.9921875,750.6666666666666,619.9921875,767.8333333333334,619.9921875,780.5833333333334C619.9921875,793.3333333333334,619.9921875,801.6666666666666,619.9921875,810C619.9921875,818.3333333333334,619.9921875,826.6666666666666,619.9921875,837.8333333333334C619.9921875,849,619.9921875,863,619.9921875,877C619.9921875,891,619.9921875,905,619.9921875,916.1666666666666C619.9921875,927.3333333333334,619.9921875,935.6666666666666,623.2176881067961,944C626.4431887135922,952.3333333333334,632.8941899271845,960.6666666666666,636.1196905339806,964.8333333333334L639.3451911407767,969"/><path marker-end="url(#flowchart-pointEnd)" style="fill:none;stroke-width:2px;stroke-dasharray:3;" class="edge-thickness-normal edge-pattern-dotted flowchart-link LS-Users LE-TOTP_Check" id="L-Users-TOTP_Check-0" d="M222.171875,402.0367024468298L235.869140625,407.5305853723582C249.56640625,413.0244682978866,276.9609375,424.01223414894326,368.3548177083333,433.6727837411383C459.7486979166667,443.3333333333333,615.1419270833334,451.6666666666667,692.8385416666666,460C770.53515625,468.3333333333333,770.53515625,476.6666666666667,770.53515625,489.4166666666667C770.53515625,502.1666666666667,770.53515625,519.3333333333334,770.53515625,536.5C770.53515625,553.6666666666666,770.53515625,570.8333333333334,770.53515625,585.1666666666666C770.53515625,599.5,770.53515625,611,770.53515625,622.5C770.53515625,634,770.53515625,645.5,770.53515625,655.4166666666666C770.53515625,665.3333333333334,770.53515625,673.6666666666666,770.53515625,686.4166666666666C770.53515625,699.1666666666666,770.53515625,716.3333333333334,770.53515625,733.5C770.53515625,750.6666666666666,770.53515625,767.8333333333334,770.53515625,780.5833333333334C770.53515625,793.3333333333334,770.53515625,801.6666666666666,770.53515625,810C770.53515625,818.3333333333334,770.53515625,826.6666666666666,770.53515625,837.8333333333334C770.53515625,849,770.53515625,863,770.53515625,877C770.53515625,891,770.53515625,905,770.53515625,916.1666666666666C770.53515625,927.3333333333334,770.53515625,935.6666666666666,777.8713845064725,944C785.2076127629449,952.3333333333334,799.8800692758899,960.6666666666666,807.2162975323625,964.8333333333334L814.5525257888349,969"/></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(1905.58984375, 622.5)" class="edgeLabel"><g transform="translate(-36.96875, -9.5)" class="label"><foreignObject height="19" width="73.9375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Public Key</span></div></foreignObject></g></g><g transform="translate(1720.01953125, 536.5)" class="edgeLabel"><g transform="translate(-86.0703125, -9.5)" class="label"><foreignObject height="19" width="172.140625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Login (User, Pass, TOTP)</span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(2711.16015625, 733.5)" class="edgeLabel"><g transform="translate(-20.7109375, -9.5)" class="label"><foreignObject height="19" width="41.421875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Token</span></div></foreignObject></g></g><g transform="translate(1556.30078125, 536.5)" class="edgeLabel"><g transform="translate(-57.6484375, -9.5)" class="label"><foreignObject height="19" width="115.296875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Mensaje Cifrado</span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(250.0625, 131.5)" class="edgeLabel"><g transform="translate(-36.96875, -9.5)" class="label"><foreignObject height="19" width="73.9375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Public Key</span></div></foreignObject></g></g><g transform="translate(962.88671875, 259.5)" class="edgeLabel"><g transform="translate(-36.96875, -9.5)" class="label"><foreignObject height="19" width="73.9375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Public Key</span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(128.5859375, 364.5)" id="flowchart-Users-109" class="node default default"><rect height="91" width="187.171875" y="-45.5" x="-93.5859375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-86.0859375, -38)" style="" class="label"><foreignObject height="76" width="172.171875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Tabla: Users<br />- ID<br />- Password Hash (HMAC)<br />- TOTP Secret</span></div></foreignObject></g></g><g transform="translate(250.0625, 61)" id="flowchart-Devices-110" class="node default default"><rect height="72" width="145.046875" y="-36" x="-72.5234375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-65.0234375, -28.5)" style="" class="label"><foreignObject height="57" width="130.046875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Tabla: Devices<br />- Public Key (PEM)<br />- Device Name</span></div></foreignObject></g></g><g transform="translate(368.6484375, 364.5)" id="flowchart-Messages-111" class="node default default"><rect height="72" width="192.953125" y="-36" x="-96.4765625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-88.9765625, -28.5)" style="" class="label"><foreignObject height="57" width="177.953125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Tabla: Messages<br />- Cifrado AES (Base64)<br />- Llave AES Cifrada (RSA)</span></div></foreignObject></g></g><g transform="translate(922.64453125, 877)" id="flowchart-AuthLayer-104" class="node default default"><rect height="34" width="175.734375" y="-17" x="-87.8671875" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-80.3671875, -9.5)" style="" class="label"><foreignObject height="19" width="160.734375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Capa de Autenticación</span></div></foreignObject></g></g><g transform="translate(895.91796875, 208)" id="flowchart-Relay-105" class="node default default"><rect height="34" width="145.46875" y="-17" x="-72.734375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-65.234375, -9.5)" style="" class="label"><foreignObject height="19" width="130.46875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Relay de Mensajes</span></div></foreignObject></g></g><g transform="translate(659.859375, 995.5)" id="flowchart-PW_Check-106" class="node default default"><rect height="53" width="169.46875" y="-26.5" x="-84.734375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-77.234375, -19)" style="" class="label"><foreignObject height="38" width="154.46875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Verificación Password<br />HMAC-SHA256</span></div></foreignObject></g></g><g transform="translate(861.2109375, 995.5)" id="flowchart-TOTP_Check-107" class="node default default"><rect height="53" width="133.234375" y="-26.5" x="-66.6171875" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-59.1171875, -19)" style="" class="label"><foreignObject height="38" width="118.234375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Verificación 2FA<br />RFC 6238 (SHA1)</span></div></foreignObject></g></g><g transform="translate(1074.37109375, 995.5)" id="flowchart-Token_Sign-108" class="node default default"><rect height="53" width="127.9375" y="-26.5" x="-63.96875" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-56.46875, -19)" style="" class="label"><foreignObject height="38" width="112.9375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Firma de Sesión<br />HMAC-SHA256</span></div></foreignObject></g></g><g transform="translate(1335.99609375, 733.5)" id="flowchart-HTTP-103" class="node default default"><rect height="34" width="175.3125" y="-17" x="-87.65625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-80.15625, -9.5)" style="" class="label"><foreignObject height="19" width="160.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Peticiones HTTP/JSON</span></div></foreignObject></g></g><g transform="translate(1956.22265625, 364.5)" id="flowchart-UI-96" class="node default default"><rect height="53" width="152.046875" y="-26.5" x="-76.0234375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-68.5234375, -19)" style="" class="label"><foreignObject height="38" width="137.046875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Interfaz de Usuario<br />(HTML/CSS/JS)</span></div></foreignObject></g></g><g transform="translate(2050.2890625, 536.5)" id="flowchart-GenKey-100" class="node default default"><rect height="53" width="168" y="-26.5" x="-84" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-76.5, -19)" style="" class="label"><foreignObject height="38" width="153"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Generación de Llaves<br />RSA-2048</span></div></foreignObject></g></g><g transform="translate(2267.484375, 536.5)" id="flowchart-Encrypt-101" class="node default default"><rect height="53" width="166.390625" y="-26.5" x="-83.1953125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-75.6953125, -19)" style="" class="label"><foreignObject height="38" width="151.390625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Cifrado Híbrido<br />AES-GCM + RSA-OAEP</span></div></foreignObject></g></g><g transform="translate(2474.4765625, 536.5)" id="flowchart-Decrypt-102" class="node default default"><rect height="34" width="147.59375" y="-17" x="-73.796875" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-66.296875, -9.5)" style="" class="label"><foreignObject height="19" width="132.59375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Descifrado Híbrido</span></div></foreignObject></g></g><g transform="translate(2024.83984375, 733.5)" id="flowchart-SessionToken-97" class="node default default"><rect height="53" width="128.5" y="-26.5" x="-64.25" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-56.75, -19)" style="" class="label"><foreignObject height="38" width="113.5"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Token de Sesión<br />(HMAC-SHA256)</span></div></foreignObject></g></g><g transform="translate(2231.92578125, 733.5)" id="flowchart-PrivKey-98" class="node default default"><rect height="53" width="185.671875" y="-26.5" x="-92.8359375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-85.3359375, -19)" style="" class="label"><foreignObject height="38" width="170.671875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Llave Privada RSA-2048<br />(Nunca sale del cliente)</span></div></foreignObject></g></g><g transform="translate(2468.23046875, 733.5)" id="flowchart-AESKey-99" class="node default default"><rect height="53" width="186.9375" y="-26.5" x="-93.46875" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(-85.96875, -19)" style="" class="label"><foreignObject height="38" width="171.9375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Llaves Efímeras AES-256<br />(Por mensaje)</span></div></foreignObject></g></g></g></g></g></svg>